<header class="{{cssClass}}" autocomplete="off">
  <div class="police-header item-hdr"> {{ localize 'ROL.spell' }}</div>
  <br>

  <section class="sheet-header">
    <img class="item-image" src="{{item.img}}"  data-action ="onEditImage" data-edit="img" title="{{item.name}}" height="75" width="75"/>
    <div class="itemheader-fields">
      <div class="skillname"><input name="name" type="text" value="{{item.name}}" placeholder="Name"/></div>
    </div>
  </section>

  <div class="skill-resource grid grid-2col">
    {{#if isGM}}
      <label class="item-label">{{ localize 'ROL.spellOrder' }}:</label>
      <select class="loc-label-inp" data-handle-change type="number" name="system.spellOrder">
        {{selectOptions spellOrderList selected=item.system.spellOrder}}
      </select>
      <label class="item-label">{{ localize 'ROL.damage' }}:</label>
      <input class="loc-label-inp" type="text" name="system.damage" value="{{system.damage}}" data-dtype="Number"/>  
    {{else}}
      <div class="item-label">{{ localize 'ROL.spellOrder' }}:</div>
      <div class="loc-label-inp">{{system.spellOrder}}</div>  
      <div class="item-label">{{ localize 'ROL.damage' }}:</div>
      <div class="loc-label-inp">{{system.damage}}</div>
    {{/if}}    
  </div>    
    {{#if (gt system.damage 0)}}
    <div class="skill-prop" style="display: block;" data-set="properties">
      <div class="item-label">{{ localize 'ROL.damageType' }}:</div>
            <div class="display-switch {{#if (eq system.damType 'blunt')}} control-active {{/if}}" title = "{{ localize 'ROL.dmgBlunt' }}" data-action="damageType" data-property='blunt'>{{ localize 'ROL.blunt' }}  </div>
            <div class="display-switch {{#if (eq system.damType 'bladed')}} control-active {{/if}}" title = "{{ localize 'ROL.dmgBladed' }}" data-action="damageType" data-property='bladed'>{{ localize 'ROL.bladed' }}  </div>
            <div class="display-switch {{#if (eq system.damType 'ballistic')}} control-active {{/if}}" title = "{{ localize 'ROL.dmgBallistic' }}" data-action="damageType" data-property='ballistic'>{{ localize 'ROL.ballistic' }}  </div>
            <div class="display-switch {{#if (eq system.damType 'magic')}} control-active {{/if}}" title = "{{ localize 'ROL.dmgMagic' }}" data-action="damageType" data-property='magic'>{{ localize 'ROL.magic' }}  </div>
            <div class="display-switch {{#if (eq system.damType 'vorpal')}} control-active {{/if}}" title = "{{ localize 'ROL.dmgVorpal' }}" data-action="damageType" data-property='vorpal'>{{ localize 'ROL.vorpal' }}  </div>
    </div>    
          <div></div>  
          <br>  
    {{/if}}  

  <div></div>
  
  <div class="item-label">{{ localize 'ROL.properties' }}:</div>
    <div class="display-switch {{#if system.mastered}} control-active {{/if}}" {{#if canEdit}} data-action ='mastered' {{/if}}>{{ localize 'ROL.mastered' }}</div>
  <div class="display-switch {{#if system.damageBoost}} control-active {{/if}}" {{#if isGM}} data-action="itemToggle" data-property='damageBoost' {{/if}}>{{ localize 'ROL.damageBoost' }}</div>
  <div></div>
  <br>


  {{!-- Pre-Requisites & Logic Partial --}}
  {{#if isGM}}
    <div class="spell-resource grid grid-2col"></div>
    <div class = "prereq">
      <label class="item-label">{{ localize 'ROL.preReq' }}:</label>
      <div class="" >
        <select class="loc-label-inp" data-handle-change name="system.preReq.logic">
          {{selectOptions logicList selected=item.system.preReq.logic}}
        </select>
      </div>
    </div>
    <div class=" grid grid-4col">
      {{#unless (eq system.preReq.logic "") }}
        <div class="item-label">{{ localize 'ROL.optA' }}</div>
          <div class="" >
            <select class="loc-label-inp" data-handle-change name="system.preReq.1.preType">
              {{selectOptions preReqList selected=item.system.preReq.1.preType}}
            </select>
          </div>
        {{#if (eq system.preReq.1.preType "Not Advantage")}}
            <select class="loc-label-inp" data-handle-change name="system.preReq.1.preOpt">
              {{selectOptions advantagesList selected=item.system.preReq.1.preOpt}}
            </select>
        {{else}}
          {{#isOr (eq system.preReq.1.preType "Char-Min") (eq system.preReq.1.preType "Char-Max")}}
            <select class="loc-label-inp" data-handle-change name="system.preReq.1.preOpt">
              {{selectOptions preOptList selected=item.system.preReq.1.preOpt}}
            </select>
          {{else}}
            <input class="prereq" type="text" name="system.preReq.1.preOpt" value="{{system.preReq.1.preOpt}}"/>
          {{/isOr}}
        {{/if}}
        <input class="prereq" type="text" name="system.preReq.1.preVal" value="{{system.preReq.1.preVal}}" data-dtype="Number"/>
    
        {{#unless (eq system.preReq.logic "A") }}  
          <div class="item-label">{{ localize 'ROL.optB' }}</div>
            <div class="" >
              <select class="loc-label-inp" data-handle-change name="system.preReq.2.preType">
                {{selectOptions preReqList selected=item.system.preReq.2.preType}}
              </select>
            </div>    {{#if (eq system.preReq.2.preType "Not Advantage")}}
              <select class="loc-label-inp" data-handle-change name="system.preReq.2.preOpt">
                {{selectOptions advantagesList selected=item.system.preReq.2.preOpt}}
              </select>
          {{else}}
            {{#isOr (eq system.preReq.2.preType "Char-Min") (eq system.preReq.2.preType "Char-Max")}}
              <select class="loc-label-inp" data-handle-change name="system.preReq.2.preOpt">
                {{selectOptions preOptList selected=item.system.preReq.2.preOpt}}
              </select>
            {{else}}
              <input class="prereq" type="text" name="system.preReq.2.preOpt" value="{{system.preReq.2.preOpt}}"/>
            {{/isOr}}
          {{/if}}
          <input class="prereq" type="text" name="system.preReq.2.preVal" value="{{system.preReq.2.preVal}}" data-dtype="Number"/>
        
          {{#isOr (eq system.preReq.logic "A and B and C") (eq system.preReq.logic "A and (B or C)") }}
          <div class="item-label">{{ localize 'ROL.optC' }}</div>
            <div class="" >
              <select class="loc-label-inp" data-handle-change name="system.preReq.3.preType">
                {{selectOptions preReqList selected=item.system.preReq.3.preType}}
              </select>
            </div>
          {{#if (eq system.preReq.3.preType "Not Advantage")}}
              <select class="loc-label-inp" data-handle-change name="system.preReq.3.preOpt">
                {{selectOptions advantagesList selected=item.system.preReq.3.preOpt}}
              </select>
          {{else}}
            {{#isOr (eq system.preReq.3.preType "Char-Min") (eq system.preReq.3.preType "Char-Max")}}
              <select class="loc-label-inp" data-handle-change name="system.preReq.3.preOpt">
                {{selectOptions preOptList selected=item.system.preReq.3.preOpt}}
              </select>
            {{else}}
              <input class="prereq" type="text" name="system.preReq.3.preOpt" value="{{system.preReq.3.preOpt}}"/>
            {{/isOr}}
          {{/if}}
          <input class="prereq" type="text" name="system.preReq.3.preVal" value="{{system.preReq.3.preVal}}" data-dtype="Number"/>
          {{/isOr}}
        {{/unless}}
      {{/unless}}
    </div>

  {{else}}
    <div class="spell-resource grid grid-2col"></div>
    <div class="item-label">{{ localize 'ROL.preReq' }}:</div>
    <div class="prereq plainboxed">{{system.preReq.logic}}</div>
    <div class=" grid grid-4col">
      {{#unless (eq system.preReq.logic "") }}
        <div class="item-label plainboxed">{{ localize 'ROL.optA' }}</div>
        <div class="prereq plainboxed">{{system.preReq.1.preType}}</div>
        <div class="prereq plainboxed">{{system.preReq.1.preOpt}}</div>
        <div class="prereq plainboxed">{{system.preReq.1.preVal}}</div>
        {{#unless (eq system.preReq.logic "A") }}  
          <div class="item-label plainboxed">{{ localize 'ROL.optB' }}</div>
          <div class="prereq plainboxed">{{system.preReq.2.preType}}</div>
          <div class="prereq plainboxed">{{system.preReq.2.preOpt}}</div>
          <div class="prereq plainboxed">{{system.preReq.2.preVal}}</div>
          {{#isOr (eq system.preReq.logic "A and B and C") (eq system.preReq.logic "A and (B or C)") }}
            <div class="item-label plainboxed">{{ localize 'ROL.optC' }}</div>
            <div class="prereq plainboxed">{{system.preReq.3.preType}}</div>
            <div class="prereq plainboxed">{{system.preReq.3.preOpt}}</div>
            <div class="prereq plainboxed">{{system.preReq.3.preVal}}</div>
          {{/isOr}}
        {{/unless}}
      {{/unless}}
    </div>
  </div>
  {{/if}} 

  <br>


  {{!-- Description  --}}
    <section class="sheet-body">
      <div class="item-label">{{ localize 'ROL.description' }}:</div>
      <div class="background-doc">
        {{#if editable}}
          <prose-mirror name="system.description" data-document-u-u-i-d="{{item.uuid}}" value="{{system.description}}"
            collaborate="true" toggled="true">
            {{{enrichedDescription}}}
          </prose-mirror>
        {{else}}
          {{{enrichedDescription}}}
        {{/if}}
      </div> 
    </section>
</header>
